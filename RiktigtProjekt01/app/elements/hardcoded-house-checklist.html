<link rel="import" href="checklist-collapse.html"
<dom-module name="hardcoded-house-checklist">
  <style is="custom-style">

    .menu-container, .menu-header-container { position: relative; }
    .menu-container > div:last-of-type { margin-bottom: 0; }
    .menu-row { margin: 8px 8px 0 8px; }
    .menu-row .inner { 
      padding: 8px;
      position: relative;
      background: #fff;
      border-radius: 0 0 3px 3px;
    }
    .menu-element {
      position: relative;
      width: 100%;
      overflow: auto;
      padding: 12px 8px;
      border:solid;
      border-width: 1px;
      border-color:lightgray;
      box-sizing: border-box;
      background: #fff;
    }
    .menu-element iron-icon { color: #227E94; }
    .menu-row.selected .menu-element, .menu-row.selected .menu-element iron-icon {  
      background: #227E94;
      color: #fff !important;
    }
    .menu-comment { overflow: auto;  padding-top: 5px;}
    .radio-button-style{
      display:block;
      font-size:12px;
      padding: 5px;
      margin:0px;
    }
    .mini-header{
      font-family:   Helvetica, Arial, sans-serif;
      font-size: 24px;
      font-style: bold;
      margin: 0px;
      text-align: center;
    }
    .menu-button{
      color:black;
      padding:0px;
      margin:0px;
      width:24px;
      height:24px;
    }
    .float-right-div{
      float:right;
    }
    iron-collapse{
      border:lightgray;
      border:solid;
      border-width: 1px;
    }
    .paper-collapse{
      margin:0px;
      padding:0px;
    }
    .main-menu{
      text-align: center;
      font-family:  Helvetica, Arial, sans-serif;
      font-size: 26px;
    }
    .super-main-menu{
      text-align: center;
      font-family:  Helvetica, Arial, sans-serif;
      font-style: bold;
      font-size: 40px;
    }
    .button-group{
      
      margin:10px;
    }
    .bottom-button{
      background-color: rgb(220,220,220);
      padding:5px 20px;
    }
    .image-div{
      flex;
      background-color: gray;
      height:200px;
    }
    .image-div img{
      height: 100%;
      width: 100%;
      padding:0;
      margin:0;
    }
    .spacetaker{
      height:30px;
    }
    paper-textarea{
      padding-bottom: 12px;
    }
  </style>

  <template>

  <h1 class= "super-main-menu">House checklist</h1>
  <div class="image-div">
    <img class="house-image" src="../images/house.png"/>
  </div>
    <h1 class= "main-menu">Vid ankomst</h1>
    <div class="menu-container">
        <!--<paper-material class="paper-collapse" elevation="3">
        <div class="menu-row" data-idx="1">
          
              <p class="mini-header">Checklistans Rubrik</p>
              <div class="menu-element">
            <iron-icon icon="content-paste"></iron-icon>&nbsp;<span>Har huset brandvarnare?</span><div class="float-right-div"><iron-icon class="menu-button" icon="radio-button-checked"></iron-icon><paper-icon-button class="menu-button" icon="content-paste" on-click="_shouldIShow()"></paper-icon-button><paper-icon-button class="menu-button" icon="create" on-click="_toggleMilestone"></paper-icon-button></div>
          </div>
          <iron-collapse id="ic" duration="0.2" role="group">
            <div class="inner">
            <paper-radio-group id="rg1" name="radio-group">
                <paper-radio-button noink class="radio-button-style" name="Ja">Ja</paper-radio-button>
                <paper-radio-button noink class="radio-button-style" name="Nej">Nej</paper-radio-button>
              </paper-radio-group>
              <p class="mini-header">Anteckning</p>
              <paper-textarea id="ta1" name="text-area" label="Kommentar i fritext" maxlength="800" char-counter ></paper-textarea>
            </div>
          </iron-collapse>
        </div>
        <div class="spacetaker"></div>
        <pre class="mini-header">Allmänna kommentarer</pre>
          <input type="text" id="general-label" value="{{generalNote}}"></input>
        </paper-material>-->
        <ul>
          <li><checklist-collapse></checklist-collapse></li>
          <li><checklist-collapse></checklist-collapse></li>
        </ul>
        
    </div>
  </template>

  <script>
    Polymer({
      is: 'hardcoded-house-checklist',

      behaviors: [],

      properties: {
        currentErrand: {
          type: Object,
          notify: true
        },
        generalNote:{
          type: String,
          notify:true
        },
        numberOfEdits:{
          type: Number,
          notify: true,
          value: 4
        }
      },

      listeners: {
        'close-milestones': '_closeOpenMilestone',
        'return-from-tillsyn': '_returnTillsyn',
        'general-label.change': '_shouldIShow'
      },
      /*


      // ##############################################################################
      // ########################## CHECK PRIVILEGES ##################################
      // ##############################################################################
      _canModifyMilestoneStatus: function(errandStatus, mode, unused) {
        if (this._checkErrandStatus(errandStatus)) return true; // disable if avslutat

        var requiredPrivs = [79, 11];
        if (mode === 'close') requiredPrivs.push(281);
        if (this._checkPrivs(this.privs, requiredPrivs)) return false;
        return true;
      },

      _canEditMilestone: function(errandStatus, milestoneStatus, searchMode) {
        if (this._checkErrandStatus(errandStatus)) return true; // disable if avslutat
        if (this._isTruthy(milestoneStatus)) return true; // true= disable element
        if (searchMode) return true; // true = disable

        var requiredPrivs = [79, 11];
        if (this._checkPrivs(this.privs, requiredPrivs)) return false;
        return true;
      },

      _canCreateMilestone: function(errandStatus, unused) {
        if (this._checkErrandStatus(errandStatus)) return true; // disable if avslutat

        var requiredPrivs = [79, 11, 179];

        if (this._checkPrivs(this.privs, requiredPrivs)) return false;
        return true;
      },

      _canDeleteMilestone: function(errandStatus, status, unused) {
        if (this._checkErrandStatus(errandStatus)) return true; // disable if avslutat

        var requiredPrivs = [79, 11, 12];
        if (status == 0) requiredPrivs.push(282);

        if (this._checkPrivs(this.privs, requiredPrivs)) return false;
        return true;
      },
      */


      // ##############################################################################
      // ########################## EVENT HANDLERS ####################################
      // ##############################################################################
     
      _toggleMilestone: function(e) {
        var clickedParent = LPA.closestAncestor(e.target, ".menu-row") || e.target;
        var milestoneDetails = clickedParent.querySelector("iron-collapse");

        // Get all rows with iron-collapse in them
        var allMilestoneElems = document.querySelectorAll("div.menu-row iron-collapse");
        for (var i = 0, len = allMilestoneElems.length; i < len; i++) {
          var elem = allMilestoneElems[i];
          if (elem.opened && elem !== milestoneDetails) {
            // If any other element is opened, close it.
            elem.opened=!elem.opened;
            // Deselect the parent element
            elem.parentElement.classList.remove('selected');
          }
        }

        // Toggle this element
        milestoneDetails.opened=!milestoneDetails.opened;

        if (milestoneDetails.opened) {
          clickedParent.classList.add('selected');
        } else {
          clickedParent.classList.remove('selected');
        }
      },

      _finishMilestone: function(evt) {
        evt.stopPropagation();
        
        var btn = LPA.closestAncestor(evt.target, 'paper-fab') || evt.target;
        if (btn.getAttribute('confirm-click')) {
          btn.removeAttribute('confirm-click');
          this.fire('hide-toast');
          this._modifyMilestoneStatus(btn, 1);
          this._setMilestoneDateToNow(evt);

        } else {
          btn.setAttribute('confirm-click', true);
          this.fire('show-toast', 'Tryck igen för att klarmarkera åtgärd');
        }
        this.fire('extend-timeout');
      },

      _openMilestone: function(evt) {
        evt.stopPropagation();

        var btn = LPA.closestAncestor(evt.target, 'paper-fab') || evt.target;
        if (btn.getAttribute('confirm-click')) {
          btn.removeAttribute('confirm-click');
          this.fire('hide-toast');
          this._modifyMilestoneStatus(btn, 0);
        } else {
          btn.setAttribute('confirm-click', true);
          this.fire('show-toast', 'Tryck igen för att öppna åtgärd');
        }
        this.fire('extend-timeout');
      },
      _closeOpenMilestone: function() {
        var selectedMilestone = this.querySelector('.menu-row.selected');
        if (selectedMilestone && selectedMilestone.classList.contains('selected')) {
          selectedMilestone.classList.remove('selected');
          selectedMilestone.querySelector('iron-collapse').toggle();
        }
      },
      _shouldIShow: function(){
        /*if(target.instancemodel.ta1.value.length>0)*/
        {
          console.log("its twerking");
        }
      }

    });
  </script>
</dom-module>